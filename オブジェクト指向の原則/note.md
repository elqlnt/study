# SOLID原則

## 単一責務の原則

- 責務=変更理由
- 3層構造
    - 画面
        - データの取得をして表示
    - ビジネスロジック
        - 頻繁に変化する
    - データアクセス
        - 永続性のあるシステムはあまり変化しない
        - ビジネスロジックとは関係ない次元で変化する
        - DBMSのバグなど
- 共通化しようという話とは別
- 多少悪いコードがスルーされるのは、書く時間だけを見ているからかも
    - 修正対象を探す時間
    - 影響範囲の確認の時間
- クラスを小さく作る
- 変更理由？
    - 

## オープンクローズドの法則

- クラスは拡張に対して開いてなければならず、修正に対して閉じていなければならない
    - 既存機能をいじらず機能追加したい
    - 呼び出し側の修正も最小限にしたい
        - 呼び出し側が呼び出し方法を変えないようにインターフェース(拡張ポイント)として定義する
        - どのクラスをnewするかはどこかで判断しなくてはいけないので、Factoryクラスで作る
        - 拡張ポイントはインターフェース、抽象クラス、仮想メソッド(非推奨)
        - 普通だと継承はほとんどしないらしい
    - 呼び出し側で分岐すると、機能追加時や分岐が増えたときに大変
    - 呼び出し側は使うものを判断したくない(インターフェースとしてみたい)
        - インターフェースを定義し、それをベースにクラスを作る
        - 例えばコンストラクタだけで判断して、あとはそれを使う
        - ↑はファクトリーに移管できる
            - `CreatePoint`みたいな
        - ここまで作ると、機能追加時にクライアントは何も変更しなくて良くなる
        - 抽象クラスを使うと処理の共通化もできる
            - アクセスレベルもいい感じに設定できる
        - 仮想メソッドだと共通化もできないし、オーバーライドしてなかったら、とかも考える必要があるので、基本的に使わない
            - 継承をさせないようにアクセスレベルを`sealed`しておくと良い
            - 具象クラスをベースにすればできるかもしれないが、一般的に抽象クラスを基底にしたほうが良い
                - `abstract`の強制力が働く
- クラスはオブジェクトではなく、インターフェースに依存する
    - やり過ぎは良くない、複雑になる
    - 可読性とのバランス
    - バリエーションが増えていくかどうか
        - DBから/csvからのGetDataとか
        - ユーザーのロールなど
- 最初から見越せるに越したことはないが、現実そうでもないので、途中でリファクタリングとかでも
- 拡張ポイントを作るべきか？