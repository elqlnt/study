---
theme: light-icons
# https://lightvue.org/getting-started/light-icons/
layout: intro
image: 'https://vuefes.jp/2024/main-visual.jpg'
title: VueFes2024
class: text-left
drawings:
  persist: false
transition: fade
mdc: true
overviewSnapshots: true
---

<div class="flex justify-center items-center absolute left-12 bottom-2 mb-60">
    <span class="text-8xl font-bold text-primary-lighter text-opacity-80" >
      <a href="https://vuefes.jp/2024/" target="_blank"
    class="text-8xl font-bold text-primary-lighter text-opacity-80">
      Vue Fes 2024
      </a>
    </span>
  </div>

---
layout: center
level: 2
---

# [Slidev](https://sli.dev/)を使ってスライドを作成してみています

<div v-click class="absolute transform">
  マークダウンベース+TailwindCSSの形式でスタイリングが可能
  <br>
  pdfやpptxに変換可能
</div>

---
layout: image-right
image: 'https://pbs.twimg.com/media/GaOMcVQbUAEards?format=jpg'
---

# 握力で技術的負債を粉砕しよう！💪

---

# 今回のテーマ

- Vueを含めたJavaScriptの将来像など
- 機能紹介系
- 技術的課題を乗り越えたお話

去年も同様でしたが、セッションが同時進行していくため、聴講できなかったセッションも多くあります。<span class="opacity-50">(⭐が聴講したセッション)</span>

---

# Vueを含めたJavaScriptの将来像など

- Oxc - The JavaScript Oxidation Compiler⭐
- UnJS: The Missing Tools for the Modern Web
- [Anthony's Road to Open Source - Yak Shaving](https://talks.antfu.me/2024/vue-fes-japan/1)

---

# 機能紹介系

- Gems of Nuxt: 8 Features Every Nuxt Developer Should Know!
- [Demystifying Vite Internals](https://speakerdeck.com/nozomuikuta/demystifying-vite-internals)
- Async State Management with Vue Router
- [Vue Vapor: Reinvention](https://talks.sxzz.moe/2024-10-vue-fes-japan/1)
- [Vaporモードを大規模サービスに最速導入して学びを共有する](https://speakerdeck.com/kazukishimamoto/vapormodowoda-gui-mo-sabisunizui-su-dao-ru-sitexue-biwogong-you-suru)⭐
- Piniaの現状と今後⭐
- [Vue3の一歩踏み込んだパフォーマンスチューニング 2024](https://speakerdeck.com/hal_spidernight/vue3no-bu-ta-miip-ndapahuomansutiyuningu2024)⭐

---

# 機能紹介系

- Trusted Types APIとVue.js⭐
- [v-modelの歩みを振り返る](https://speakerdeck.com/bengo4com/20241019-cloudsign-vuefesjapan2024-2)⭐
- [Vue SFCのtemplateでTypeScriptの型を活用しよう](https://speakerdeck.com/tsukkee/vue-sfcnotemplatetetypescriptnoxing-wohuo-yong-siyou)⭐
- [Vue 3 と Svelte 5 のランタイムを比較する 〜技術を一段深く理解する〜](https://docs.google.com/presentation/d/1xvcDewSssDweawP3ZnkQi0L-1AjaOl5oD8YFiiZuk3A/edit#slide=id.p)
- [Deep dive into Nuxt Server Components](https://speakerdeck.com/wattanx/deep-dive-into-nuxt-server-components)
- [Vitest Browser Mode への期待](https://speakerdeck.com/odanado/vitest-browser-mode)
- Protocol BuffersとNuxt3で開発生産性を上げるためのスキーマファースト開発の紹介
- [Nuxt × Vue Router の力を最大限を引き出す機能を紹介 ～Typed Pages, Nested Routes, Routes' Matching Syntax～](https://speakerdeck.com/ytr0903/nuxt-x-vue-router-noli-wozui-da-xian-niyin-kichu-suji-neng-woshao-jie)
- Vue.jsプロジェクトに出てくるeslintと仲良くなる


---

# 技術的課題を乗り越えたお話

- [普通のエンジニアが頑張って30万行のNuxt3バージョンアップした話](https://speakerdeck.com/konkarin/vue-fes-japan-2024-nuxt3-version-up)
- フロントエンドエンジニアのいない組織でVue.jsを導入するまで
- [VueとViteで作るUIコンポーネントライブラリ ~デザインシステムとプロダクトの理想的な分離を目指して~](https://speakerdeck.com/bengo4com/20241019-cloudsign-vuefesjapan2024-1)⭐
- [AIとともに歩んだライブラリアップデートの道のり](https://speakerdeck.com/lmi/vue-fes-japan-2024-link-and-motivation)⭐
- [Vue.js、Nuxtの機能を使い、大量のコピペコードをリファクタリングする](https://speakerdeck.com/igayamaguchi/⭐vue-dot-js-nuxtnoji-neng-woshi-i-da-liang-nokopipekodoworihuakutaringusuru)
- [段階的なレンダリングを実装してUXを最大化するためのTips](https://speakerdeck.com/reibomaru/duan-jie-de-narentarinkuwoshi-zhuang-siteuxwozui-da-hua-surutamenotips)⭐
- [2万ページのSSG運用における工夫と注意点](https://speakerdeck.com/chinen/vue-fes-japan-2024)
- [Vaporモードを大規模サービスに最速導入して学びを共有する](https://speakerdeck.com/kazukishimamoto/vapormodowoda-gui-mo-sabisunizui-su-dao-ru-sitexue-biwogong-you-suru)⭐

--- 

# その他/未聴講のため不明

- IT未経験者をVue.jsで開発できるITコンサルタントに育てあげる秘訣 - フューチャーの新人研修の取り組み⭐
- [Vueでサクッと作って試す：STUDIOでのプロトタイピング開発](https://speakerdeck.com/ryunosukeheaven/vue-desakututozuo-ru-studio-denopurototaipingukai-fa)⭐
- Nuxtベースの「WXT」で開発用のChrome拡張を作成する
- 同期する都市のキャンバス：Vue.jsによる大規模メディアインスタレーションの舞台裏
- [Nuxt UI Pro、NuxtHub、Nuxt Scripts、Nuxtエコシステムをふんだんに利用して開発するコーポレートサイト](https://speakerdeck.com/shingangan/nuxt-ui-pro-nuxthub-nuxt-scripts-nuxtekosisutemuwohundannili-yong-sitekai-fa-surukoporetosaito-at-vue-fes-japan-2024)
- [/←このスケジュール表に立ち向かうフロントエンド開発戦略](https://speakerdeck.com/nrslib/a-front-end-development-strategy-to-tackle-a-single-slash-schedule)
  - アフターパーティで発表されたモノ

---
layout: center
---

# エコシステムのお話

---
layout: center
---

# 最初に登場したOxcとは

---
layout: iframe-right
url: 'https://oxc.rs/'
---

- Oxidation Compiler<span class="opacity-50 text-xs px-1">錆(Rust)/酸化(Oxidation)?</span>
- Rustで記述されたJavaScriptのツールチェイン
  - Parser
  - Linter
  - Resolver
  - Transformer🚧
  - Minifier🚧
  - Formatter🚧
  - Rolldown Bundler🚧
  - Nova JavaScript Engine🚧

---

# 既存ツールに対し、なぜこのようなものが開発されているのか

[Announcing VoidZero - Next Generation Toolchain for JavaScript](https://voidzero.dev/posts/announcing-voidzero-inc)

> Over the years, many excellent tools have emerged to address the increasing scale and complexity of JavaScript applications. However, the ecosystem has always been fragmented: every application relies on a myriad of third-party dependencies, and configuring them to work well together remains one of the most daunting tasks in the development cycle.

> As the author of one of the most widely used frontend frameworks, I’ve spent significant effort researching every layer of the JavaScript tooling stack, assembling hundreds of dependencies, and designing complex abstractions on top of them. The goal was always to give end users a cohesive, out-of-the-box development experience. These efforts eventually led to the creation of Vite in 2020.

<v-clicks>

- フロントエンド開発のエコシステムは進化を続けているが課題を抱えている
  - 無数のサードパーティ性のライブラリに依存しており、一貫性を保つために色々無理をしている
  - 異なるツール間でのパースやシリアライズの重複によってパフォーマンスが頭打ちに
- <span class="font-bold text-emerald">これはJavaScriptのエコシステム全体の問題</span>

</v-clicks>

---
layout: iframe-right
url: 'https://voidzero.dev/'
---

# 

Evan達はこのような課題を解決するべく、VoidZeroを立ち上げて活動を始めました

> - Unified: It should use the same AST, resolver, and module interop for all tasks, eliminating inconsistencies and reducing redundant parsing costs.
> - High Performance: The foundational components should be written in a compile-to-native language and designed from the ground up for speed, unlocking more ambitious optimizations.
> - Composable: Each component of the toolchain should be independently consumable, offering building blocks for advanced customization.
> - Runtime Agnostic: The core of the toolchain should not be coupled to any specific JavaScript runtime so that developers can enjoy the same benefits across all environments.

---

# Viteが抱えている課題

- 開発環境と本番環境で異なるビルドツール
  - 開発環境：esbuild
  - 本番環境：Rollup

先程出てきたRolldownは、上記の課題を解決するために、新たにRustで作成されているものです。
<br>
これによって差異がなくなる上に、パフォーマンスが非常に向上します。

<div class="flex justify-center">
  <img class="px-10 h-60" src='https://pbs.twimg.com/media/GaN_1qcbUAEHvj8?format=jpg'/>
</div>

---

# 時代はRust🦀

メモリ効率やパフォーマンス、バンドルサイズで優位性があるRustに...

||比較対象|速さ|互換性|
|---|---|---|---|
|Parser|swc<span class="opacity-50" style="font-size: 0.4em">←これもRust製ですが...</span>|3x|✅|
|Linter|ESlint|50~100x|一部|
|Resolver|enhanced-resolve|28x|✅|
|Transformer|Babel|40x|✅|
|Formatter|Prettier||✅|
|Rolldown Bundler|Rollup|100x|✅

<div v-click class="absolute transform">
  ちなみにWebPack互換の<a href="https://rspack.dev/">Rspack</a>もあり、フロントエンドエコシステムのRust化が進んでいます。
</div>

---
layout: center
---

# 🍢

---
layout: center
---

# 次のVite6からこれらに置き換わっていきます

---
layout: center
---

# Vue自身のお話

---
layout: two-cols
---

# Vueの歩み

- Vue2
  - Options API
- Vue2.7
  - Composition API
- Vue3.3
  - TypeScript連携の強化
  - `defineSlots`
- Vue3.4<span class="text-red">←イマココ</span>
  - `defineModel`

::right::

<v-click>

- Vue3.5←最新はココ
  - メモリ効率<light-icon icon="trending-up" />
  - Trusted Types API
  - `useTemplateRef`
- Vue3.6
  - `Suspense`
  - Vaporモード(実験的)
  - より良いパフォーマンス

</v-click>

---
layout: center
---

# ...Composition API+TypeScriptの話しかない

---
layout: two-cols
---

- そもそもOptions APIはTypeScriptとの親和性が微妙だった
  - 内部的にめちゃくちゃに複雑なことをしなければならない
  - 様々な機能に対して型推論が完璧にはできていない

<v-clicks depth="2">

- Vue2.6で満を持してのComposition APIサポート
  - 論理的関心の対象がコード上でまとまるように
    - template<light-icon icon="arrows-horizontal" />methods<light-icon icon="arrows-horizontal" />styleが分離
  - 状態を持った関数を再利用する仕組み
    - ミックスインは公式でもおすすめされていなかった
      - プロパティの発生元が不明瞭
      - 名前空間の衝突
      - 暗黙的なミックスイン間のやりとり
- [ReactHooksと似ている](https://ja.vuejs.org/guide/extras/composition-api-faq#comparison-with-react-hooks)
- 従来は大規模開発に向かないと言われていたがこれを解決
- このため、Options API→Composition APIの書き換えをするプロジェクトも多くある

</v-clicks>

::right::

<div class="flex justify-center items-center h-full" v-click="2">
  <img class="px-10 h-80" src="https://ja.vuejs.org/assets/composition-api-after.ZXskY_32.png"/>
</div>

---
layout: center
---

- Options APIは非推奨ではないが、今後Vueとして機能の強化がはかられていくのはComposition APIになりそう
- 上記の前提で以降のお話をします

---
clicks: 1
---

# 講演で取り上げられていた機能を見てみる

- 関数系
  - [`defineSlots`](https://ja.vuejs.org/api/sfc-script-setup#defineslots)
  - [`defineModel`](https://ja.vuejs.org/api/sfc-script-setup#definemodel)
  - [`useTemplateRef`](https://ja.vuejs.org/api/composition-api-helpers#usetemplateref)
  - [`Suspense`](https://ja.vuejs.org/guide/built-ins/suspense)
- <span :class="$clicks > 0 && 'opacity-50'">Trusted Types API</span>
  - <span :class="$clicks > 0 && 'opacity-50'">XSS対策</span>
  - <span :class="$clicks > 0 && 'opacity-50'">テンプレート内での型安全なDOM操作</span>
- <span :class="$clicks > 0 && 'opacity-50'">Vaporモード</span>

---

- [`defineSlots`](https://ja.vuejs.org/api/sfc-script-setup#defineslots)
  - Slotを型付け
- <span class="opacity-50">[`defineModel`](https://ja.vuejs.org/api/sfc-script-setup#definemodel)</span>
- <span class="opacity-50">[`useTemplateRef`](https://ja.vuejs.org/api/composition-api-helpers#usetemplateref)</span>
- <span class="opacity-50">[`Suspense`](https://ja.vuejs.org/guide/built-ins/suspense)</span>

````md magic-move {lines: true}
```ts {*|2|*}
// step 1
const author = reactive({
  name: 'John Doe',
  books: [
    'Vue 2 - Advanced Guide',
    'Vue 3 - Basic Guide',
    'Vue 4 - The Mystery'
  ]
})
```

```ts {*|1-2|3-4|3-4,8}
// step 2
export default {
  data() {
    return {
      author: {
        name: 'John Doe',
        books: [
          'Vue 2 - Advanced Guide',
          'Vue 3 - Basic Guide',
          'Vue 4 - The Mystery'
        ]
      }
    }
  }
}
```

```ts
// step 3
export default {
  data: () => ({
    author: {
      name: 'John Doe',
      books: [
        'Vue 2 - Advanced Guide',
        'Vue 3 - Basic Guide',
        'Vue 4 - The Mystery'
      ]
    }
  })
}
```

Non-code blocks are ignored.

```vue
<!-- step 4 -->
<script setup>
const author = {
  name: 'John Doe',
  books: [
    'Vue 2 - Advanced Guide',
    'Vue 3 - Basic Guide',
    'Vue 4 - The Mystery'
  ]
}
</script>
```
````

---
clicks: 1
---

# 講演で取り上げられていた機能を見てみる

- <span :class="$clicks > 0 && 'opacity-50'">関数系</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`defineSlots`](https://ja.vuejs.org/api/sfc-script-setup#defineslots)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`defineModel`](https://ja.vuejs.org/api/sfc-script-setup#definemodel)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`useTemplateRef`](https://ja.vuejs.org/api/composition-api-helpers#usetemplateref)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`Suspense`](https://ja.vuejs.org/guide/built-ins/suspense)</span>
- Trusted Types API
  - XSS対策
  - テンプレート内での型安全なDOM操作
- <span :class="$clicks > 0 && 'opacity-50'">Vaporモード</span>

---
clicks: 2
---

# 講演で取り上げられていた機能を見てみる

- <span :class="$clicks > 0 && 'opacity-50'">関数系</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`defineSlots`](https://ja.vuejs.org/api/sfc-script-setup#defineslots)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`defineModel`](https://ja.vuejs.org/api/sfc-script-setup#definemodel)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`useTemplateRef`](https://ja.vuejs.org/api/composition-api-helpers#usetemplateref)</span>
  - <span :class="$clicks > 0 && 'opacity-50'">[`Suspense`](https://ja.vuejs.org/guide/built-ins/suspense)</span>
- <span :class="$clicks > 0 && 'opacity-50'">Trusted Types API</span>
  - <span :class="$clicks > 0 && 'opacity-50'">XSS対策</span>
  - <span :class="$clicks > 0 && 'opacity-50'">テンプレート内での型安全なDOM操作</span>
- Vaporモード<span class="text-red" v-click="2">←？</span>

---
layout: center
---

# Vaporモード？

---
layout: iframe
url: 'https://talks.sxzz.moe/2024-10-vue-fes-japan/5?clicks=5'
---

---
layout: iframe-right
url: 'https://speakerdeck.com/player/f34ec1469d5244b7a791f40fca66b41e?slide=15'
---

# 新たなレンダリング戦略

- Vue<div i-logos:vue class="inline-block"/>やReact<div i-logos:react class="inline-block"/>はレンダリング時にDOMを直接更新せず、仮想DOM(`VNode`のオブジェクトツリー)を通して管理している
  - 更新のたびにDOMツリー全体が再構築されることを防ぐため

<v-clicks>

もし仮想DOMを介さずにレンダリングできたら...

- レンダリングコスト<light-icon icon="trending-down" />
- ランタイムコード<light-icon icon="trending-down" />
- メモリ効率<light-icon icon="trending-up" />

</v-clicks>

---
layout: iframe-right
url: 'https://speakerdeck.com/player/f34ec1469d5244b7a791f40fca66b41e?slide=74'
---

<div class="flex justify-center items-center h-full">
  バンドルサイズ(コンポーネント数：130)
</div>

---
layout: iframe-right
url: 'https://speakerdeck.com/player/f34ec1469d5244b7a791f40fca66b41e?slide=107'
---

<div class="flex justify-center items-center h-full">
  初期描画(コンポーネント数：1000)
</div>

---
layout: iframe-right
url: 'https://speakerdeck.com/player/f34ec1469d5244b7a791f40fca66b41e?slide=110'
---

<div class="flex justify-center items-center h-full">
  更新描画(コンポーネント数：1000)
  <br>
  レンダリングとペイントがVaporオンのときに遅いのは、更新回数が多いかららしい
</div>

---

# Vaporモードを導入するには？

- Vueを更新してVaporモードをONにするだけ
- element-plusにも対応

<v-click>

[Vue Vapor: Reinvention](https://talks.sxzz.moe/2024-10-vue-fes-japan/1)のスピーカーはelement-plusでよく出てくるこの方

<div class="flex justify-center">
  <iframe src="https://xlog.sxzz.moe/" class="h-72 w-96"/>
</div>

</v-click>

---

# 注意点

<v-clicks depth="2">

- Vaporモードは現在開発途中
- <span class="text-red">Composition API限定😢</span>
  - このあとにAIを活用した書き換えのお話もします

</v-clicks>

---

# その他技術周りのお話し

---

# その他技術周りのお話し

- AIを活用した事例
  - Composition API/TypeScriptへの書き換え
  - プロトタイピング
- デザインシステムとプロダクトの分離
  - Zeroheight
- リファクタリング
- パフォーマンスチューニング

---

# Composition APIに変換するツールがあるらしい...

[Composition API Converter](https://wattanx-converter.vercel.app/)

---

# まとめ

- フロントエンドのエコシステムは更に進化し続ける
  - 進むRust化
- Vue自身もどんどん便利に
- Composition API + TypeScriptが主流に
  - Vue自身の強化もこれを前提にしたものになっていきそう
- 最近OSS活動で燃え尽きるがﾁﾗﾁﾗ出てきているらしいので、OSS活動に興味がある人大募集中らしいです

---

# 学習サイト

- Vue自体の仕組みをもっと知りたい→[ChibiVue](https://ubugeeei.github.io/chibivue/)
- Vite自体の仕組みをもっと知りたい→[ChibiVite](https://nozomuikuta.github.io/chibivite/)
